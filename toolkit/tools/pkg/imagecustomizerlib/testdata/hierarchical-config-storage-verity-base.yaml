storage:
  bootType: efi
  disks:
  - partitionTableType: gpt
    partitions:
    - id: esp
      type: esp
      size: 8M

    - id: usr
      size: 2G

    - id: usrhash
      size: 100M

  filesystems:
  - deviceId: esp
    type: fat32
    mountPoint:
      path: /boot/efi
      options: umask=0077

  - deviceId: verityusr
    type: ext4
    mountPoint:
      path: /usr
      options: ro

  verity:
  - id: verityusr
    name: usr
    dataDeviceId: usr
    hashDeviceId: usrhash

input:
  image:
    path: testimages/empty-base.vhdx

output:
  image:
    path: ./out/storage-reinit-verity.vhdx
    format: vhdx

os:
  bootloader:
    resetType: hard-reset
