storage:
  disks:
  - partitionTableType: gpt
    partitions:
    - id: esp
      type: esp
      size: 8M

    - id: btrfspart
      size: 3G

  bootType: efi

  filesystems:
  - deviceId: esp
    type: fat32
    mountPoint:
      path: /boot/efi
      options: umask=0077

  - deviceId: btrfspart
    type: btrfs
    btrfs:
      subvolumes:
      - path: root
        mountPoint:
          path: /
      - path: home
        mountPoint:
          path: /home
        quota:
          referencedLimit: 500M
      - path: root/var
        mountPoint:
          path: /var
      - path: root/var/log
        mountPoint:
          path: /var/log
          options: noatime
        quota:
          referencedLimit: 100M
          exclusiveLimit: 50M
      - path: snapshots
        # No mount point - just for btrfs snapshots

os:
  bootloader:
    resetType: hard-reset

previewFeatures:
- btrfs
