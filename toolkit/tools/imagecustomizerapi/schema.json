{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://github.com/microsoft/azurelinux/toolkit/tools/imagecustomizerapi/config",
    "$ref": "#/$defs/Config",
    "$defs": {
        "AdditionalFile": {
            "properties": {
                "Destination": {
                    "type": "string"
                },
                "Source": {
                    "type": "string"
                },
                "Content": {
                    "type": "string"
                },
                "Permissions": {
                    "type": "integer"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Destination",
                "Source",
                "Content",
                "Permissions"
            ]
        },
        "AdditionalFileList": {
            "items": {
                "$ref": "#/$defs/AdditionalFile"
            },
            "type": "array"
        },
        "Config": {
            "properties": {
                "Storage": {
                    "$ref": "#/$defs/Storage"
                },
                "Iso": {
                    "$ref": "#/$defs/Iso"
                },
                "Pxe": {
                    "$ref": "#/$defs/Pxe"
                },
                "OS": {
                    "$ref": "#/$defs/OS"
                },
                "Scripts": {
                    "$ref": "#/$defs/Scripts"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Storage",
                "Iso",
                "Pxe",
                "OS",
                "Scripts"
            ]
        },
        "DirConfig": {
            "properties": {
                "Source": {
                    "type": "string"
                },
                "Destination": {
                    "type": "string"
                },
                "NewDirPermissions": {
                    "type": "integer"
                },
                "MergedDirPermissions": {
                    "type": "integer"
                },
                "ChildFilePermissions": {
                    "type": "integer"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Source",
                "Destination",
                "NewDirPermissions",
                "MergedDirPermissions",
                "ChildFilePermissions"
            ]
        },
        "DirConfigList": {
            "items": {
                "$ref": "#/$defs/DirConfig"
            },
            "type": "array"
        },
        "Disk": {
            "properties": {
                "PartitionTableType": {
                    "type": "string"
                },
                "MaxSize": {
                    "type": "integer"
                },
                "Partitions": {
                    "items": {
                        "$ref": "#/$defs/Partition"
                    },
                    "type": "array"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "PartitionTableType",
                "MaxSize",
                "Partitions"
            ]
        },
        "FileSystem": {
            "properties": {
                "DeviceId": {
                    "type": "string"
                },
                "Type": {
                    "type": "string"
                },
                "MountPoint": {
                    "$ref": "#/$defs/MountPoint"
                },
                "PartitionId": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "DeviceId",
                "Type",
                "MountPoint",
                "PartitionId"
            ]
        },
        "Iso": {
            "properties": {
                "KernelCommandLine": {
                    "$ref": "#/$defs/KernelCommandLine"
                },
                "AdditionalFiles": {
                    "$ref": "#/$defs/AdditionalFileList"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "KernelCommandLine",
                "AdditionalFiles"
            ]
        },
        "KernelCommandLine": {
            "properties": {
                "ExtraCommandLine": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "ExtraCommandLine"
            ]
        },
        "Module": {
            "properties": {
                "Name": {
                    "type": "string"
                },
                "LoadMode": {
                    "type": "string"
                },
                "Options": {
                    "additionalProperties": {
                        "type": "string"
                    },
                    "type": "object"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Name",
                "LoadMode",
                "Options"
            ]
        },
        "MountPoint": {
            "properties": {
                "IdType": {
                    "type": "string"
                },
                "Options": {
                    "type": "string"
                },
                "Path": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "IdType",
                "Options",
                "Path"
            ]
        },
        "OS": {
            "properties": {
                "ResetBootLoaderType": {
                    "type": "string"
                },
                "Hostname": {
                    "type": "string"
                },
                "Packages": {
                    "$ref": "#/$defs/Packages"
                },
                "SELinux": {
                    "$ref": "#/$defs/SELinux"
                },
                "KernelCommandLine": {
                    "$ref": "#/$defs/KernelCommandLine"
                },
                "AdditionalFiles": {
                    "$ref": "#/$defs/AdditionalFileList"
                },
                "AdditionalDirs": {
                    "$ref": "#/$defs/DirConfigList"
                },
                "Users": {
                    "items": {
                        "$ref": "#/$defs/User"
                    },
                    "type": "array"
                },
                "Services": {
                    "$ref": "#/$defs/Services"
                },
                "Modules": {
                    "items": {
                        "$ref": "#/$defs/Module"
                    },
                    "type": "array"
                },
                "Overlays": {
                    "items": {
                        "$ref": "#/$defs/Overlay"
                    },
                    "type": "array"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "ResetBootLoaderType",
                "Hostname",
                "Packages",
                "SELinux",
                "KernelCommandLine",
                "AdditionalFiles",
                "AdditionalDirs",
                "Users",
                "Services",
                "Modules",
                "Overlays"
            ]
        },
        "Overlay": {
            "properties": {
                "LowerDirs": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "UpperDir": {
                    "type": "string"
                },
                "WorkDir": {
                    "type": "string"
                },
                "MountPoint": {
                    "type": "string"
                },
                "IsInitrdOverlay": {
                    "type": "boolean"
                },
                "MountDependencies": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "MountOptions": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "LowerDirs",
                "UpperDir",
                "WorkDir",
                "MountPoint",
                "IsInitrdOverlay",
                "MountDependencies",
                "MountOptions"
            ]
        },
        "Packages": {
            "properties": {
                "UpdateExistingPackages": {
                    "type": "boolean"
                },
                "InstallLists": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "Install": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "RemoveLists": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "Remove": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "UpdateLists": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "Update": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "UpdateExistingPackages",
                "InstallLists",
                "Install",
                "RemoveLists",
                "Remove",
                "UpdateLists",
                "Update"
            ]
        },
        "Partition": {
            "properties": {
                "Id": {
                    "type": "string"
                },
                "Label": {
                    "type": "string"
                },
                "Start": {
                    "type": "integer"
                },
                "End": {
                    "type": "integer"
                },
                "Size": {
                    "$ref": "#/$defs/PartitionSize"
                },
                "Type": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Id",
                "Label",
                "Start",
                "End",
                "Size",
                "Type"
            ]
        },
        "PartitionSize": {
            "properties": {
                "Type": {
                    "type": "integer"
                },
                "Size": {
                    "type": "integer"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Type",
                "Size"
            ]
        },
        "Password": {
            "properties": {
                "Type": {
                    "type": "string"
                },
                "Value": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Type",
                "Value"
            ]
        },
        "Pxe": {
            "properties": {
                "IsoImageBaseUrl": {
                    "type": "string"
                },
                "IsoImageFileUrl": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "IsoImageBaseUrl",
                "IsoImageFileUrl"
            ]
        },
        "SELinux": {
            "properties": {
                "Mode": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Mode"
            ]
        },
        "Script": {
            "properties": {
                "Path": {
                    "type": "string"
                },
                "Content": {
                    "type": "string"
                },
                "Interpreter": {
                    "type": "string"
                },
                "Arguments": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "EnvironmentVariables": {
                    "additionalProperties": {
                        "type": "string"
                    },
                    "type": "object"
                },
                "Name": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Path",
                "Content",
                "Interpreter",
                "Arguments",
                "EnvironmentVariables",
                "Name"
            ]
        },
        "Scripts": {
            "properties": {
                "PostCustomization": {
                    "items": {
                        "$ref": "#/$defs/Script"
                    },
                    "type": "array"
                },
                "FinalizeCustomization": {
                    "items": {
                        "$ref": "#/$defs/Script"
                    },
                    "type": "array"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "PostCustomization",
                "FinalizeCustomization"
            ]
        },
        "Services": {
            "properties": {
                "Enable": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "Disable": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Enable",
                "Disable"
            ]
        },
        "Storage": {
            "properties": {
                "ResetPartitionsUuidsType": {
                    "type": "string"
                },
                "BootType": {
                    "type": "string"
                },
                "Disks": {
                    "items": {
                        "$ref": "#/$defs/Disk"
                    },
                    "type": "array"
                },
                "FileSystems": {
                    "items": {
                        "$ref": "#/$defs/FileSystem"
                    },
                    "type": "array"
                },
                "Verity": {
                    "items": {
                        "$ref": "#/$defs/Verity"
                    },
                    "type": "array"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "ResetPartitionsUuidsType",
                "BootType",
                "Disks",
                "FileSystems",
                "Verity"
            ]
        },
        "User": {
            "properties": {
                "Name": {
                    "type": "string"
                },
                "UID": {
                    "type": "integer"
                },
                "Password": {
                    "$ref": "#/$defs/Password"
                },
                "PasswordExpiresDays": {
                    "type": "integer"
                },
                "SSHPublicKeyPaths": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "SSHPublicKeys": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "PrimaryGroup": {
                    "type": "string"
                },
                "SecondaryGroups": {
                    "items": {
                        "type": "string"
                    },
                    "type": "array"
                },
                "StartupCommand": {
                    "type": "string"
                },
                "HomeDirectory": {
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Name",
                "UID",
                "Password",
                "PasswordExpiresDays",
                "SSHPublicKeyPaths",
                "SSHPublicKeys",
                "PrimaryGroup",
                "SecondaryGroups",
                "StartupCommand",
                "HomeDirectory"
            ]
        },
        "Verity": {
            "properties": {
                "Id": {
                    "type": "string"
                },
                "Name": {
                    "type": "string"
                },
                "DataDeviceId": {
                    "type": "string"
                },
                "DataDeviceMountIdType": {
                    "type": "string"
                },
                "HashDeviceId": {
                    "type": "string"
                },
                "HashDeviceMountIdType": {
                    "type": "string"
                },
                "CorruptionOption": {
                    "type": "string"
                },
                "FileSystem": {
                    "$ref": "#/$defs/FileSystem"
                }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
                "Id",
                "Name",
                "DataDeviceId",
                "DataDeviceMountIdType",
                "HashDeviceId",
                "HashDeviceMountIdType",
                "CorruptionOption",
                "FileSystem"
            ]
        }
    }
}
